<aside class="aside">
    <!-- START Sidebar (left)-->
    <div class="aside-inner">
        <nav data-sidebar-anyclick-close="" class="sidebar">
            <!-- START sidebar nav-->
            <ul class="nav">
                <!-- Iterates over all sidebar items-->
                <li class="nav-heading ">
                    <span>My Courses</span>
                </li>
                {{#each own_courses}}
                    <li>
                        <a href="/class?cid={{id}}">
                            <em class="fa fa-book"></em>
                            <span>{{course_title}}</span>
                        </a>
                    </li>
                {{/each}}
            </ul>
            <!-- END sidebar nav-->
        </nav>
    </div>
    <!-- END Sidebar (left)-->
</aside>
<!-- Main section-->
<section>
    <!-- Page content-->
    <div class="content-wrapper">
        <h3>{{#if edits}}Your{{else}}{{user.fname}}'s{{/if}} Profile
            <small>View your own and others' profiles</small>

            <form class="pull-right" style="width: 300px; padding: 22px 20px; position: absolute; right: 0; top: 0">
                <div class="input-group">
                    <label for="message" class="sr-only">Find a profile</label>
                    <input id="friend_search_bar_profile" type="text" placeholder="Find a profile" class="form-control">
                                    <span class="input-group-btn">
                                        <button class="btn btn-default">Search</button>
                                    </span>
                </div>
            </form>
        </h3>

        <!-- START row-->
        <div class="row">
            <div class="col-md-6">
                <!-- START widget-->
                <div class="panel widget">
                    <div class="half-float">
                        <img src="img/bg3.jpg" alt="" class="img-responsive">
                        <div class="half-float-bottom">
                            <img id="profilePicture" src="{{user.profile_picture_url}}" alt="No Profile Picture" class="img-thumbnail img-circle thumb128">
                        </div>
                    </div>
                    <div class="panel-body text-center">
                        <h3 class="m0">Ted Berry</h3>
                        <p class="text-muted">Lead director</p>
                        <p>Proin metus justo, commodo in ultrices at, lobortis sit amet dui. Fusce dolor purus, adipiscing a tempus at, gravida vel purus.</p>
                    </div>
                    <div class="panel-body text-center bg-gray-dark">
                        <div class="row row-table">
                            <div class="col-xs-4">
                                <h3 class="m0">400</h3>
                                <p class="m0">Photos</p>
                            </div>
                            <div class="col-xs-4">
                                <h3 class="m0">2000</h3>
                                <p class="m0">Likes</p>
                            </div>
                            <div class="col-xs-4">
                                <h3 class="m0">500</h3>
                                <p class="m0">Following</p>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- END widget-->
            </div>
            <div class="col-md-6">
                {{#if edits}}
                    <form method="post" enctype="multipart/form-data" action = "/upload">
                        <input type="file" name="photo" required>
                        <input type="submit">
                    </form>
                {{/if}}

                <div id="profileInfo">
                    <p><Strong>{{user.fname}} {{user.lname}}</Strong></p>
                    {{#if edits}}
                        <span class="btn-group">
                            <button class="btn btn-mini" id = "year_edit" onclick="saveInfo(this)" value = 'grad_text'>Edit</button>
                        </span>
                    {{/if}}

                    <br>Graduation Year: <textarea rows="1" id="grad_text" disabled="disabled" placeholder="N/A">{{user.year}}</textarea><br>
                    {{#if edits}}
                        <span class="btn-group">
                            <button class="btn btn-mini" id = "major_edit" onclick="saveInfo(this)" value = 'major_text'>Edit</button>
                        </span>
                    {{/if}}
                    <br>
                    Major:<textarea rows="1" id ="major_text" disabled="disabled" placeholder="N/A">{{user.major}}</textarea>
                    <br>
                </div>

                <div id="currentCourses">
                    <h3>Current Courses</h3>
                    {{#each courses}}
                        <div class="course">
                            <p>{{course_title}}</p>
                        </div>
                    {{/each}}
                </div>

                <div id="biography">

                    <h3 id="bio_header"> Biography
                        {{#if edits}}
                            <span class="btn-group">
                                <button class="btn btn-mini" id = "acts_edit" onclick="saveInfo(this)" value = 'bio_text'>Edit</button>
                            </span>
                        {{/if}}
                    </h3>
                    <textarea cols="50" id = "bio_text" disabled = disabled>{{user.biography}}</textarea>

                </div>

                <div id="activities">
                    <h3 id="bio_header"> Activities/Clubs
                        {{#if edits}}
                            <span class="btn-group">
                                <button class="btn btn-mini" id = "bio_edit" onclick="saveInfo(this)" value = 'acts_text'>Edit</button>
                            </span>
                        {{/if}}
                    </h3>
                    <textarea cols="50" id = "acts_text" disabled = disabled>{{user.activities}}</textarea>
                </div>
            </div>
        </div>
        <!-- END row-->

        <hr>

        <!-- START row-->
        <div class="row">
            <div class="col-xs-12">
                <div id="friend_search_content_profile">
                    <div id="friend_search_error_profile"></div>
                    <ul id="friend_search_results_profile" style="list-style-type: none; padding-left: 6px"></ul>
                </div>

                <div>{{message}}</div>

                <img id='profilePicture' src="{{user.profile_picture_url}}" alt="No Profile Picture" width = "100" height="100">
                {{#if edits}}
                    <form method="post" enctype="multipart/form-data" action = "/upload">
                        <input type="file" name="photo" required>
                        <input type="submit">
                    </form>
                {{/if}}

                <div id="profileInfo">
                    <p><Strong>{{user.fname}} {{user.lname}}</Strong></p>
                    {{#if edits}}
                        <span class="btn-group">
                            <button class="btn btn-mini" id = "year_edit" onclick="saveInfo(this)" value = 'grad_text'>Edit</button>
                        </span>
                    {{/if}}

                    <br>Graduation Year: <textarea rows="1" id="grad_text" disabled="disabled" placeholder="N/A">{{user.year}}</textarea><br>
                    {{#if edits}}
                        <span class="btn-group">
                            <button class="btn btn-mini" id = "major_edit" onclick="saveInfo(this)" value = 'major_text'>Edit</button>
                        </span>
                    {{/if}}
                    <br>
                    Major:<textarea rows="1" id ="major_text" disabled="disabled" placeholder="N/A">{{user.major}}</textarea>
                    <br>
                </div>

                <div id="currentCourses">
                    <h3>Current Courses</h3>
                    {{#each courses}}
                        <div class="course">
                            <p>{{course_title}}</p>
                        </div>
                    {{/each}}
                </div>

                <div id="biography">

                    <h3 id="bio_header"> Biography
                        {{#if edits}}
                            <span class="btn-group">
                                <button class="btn btn-mini" id = "acts_edit" onclick="saveInfo(this)" value = 'bio_text'>Edit</button>
                            </span>
                        {{/if}}
                    </h3>
                    <textarea cols="50" id = "bio_text" disabled = disabled>{{user.biography}}</textarea>

                </div>

                <div id="activities">
                    <h3 id="bio_header"> Activities/Clubs
                        {{#if edits}}
                            <span class="btn-group">
                                <button class="btn btn-mini" id = "bio_edit" onclick="saveInfo(this)" value = 'acts_text'>Edit</button>
                            </span>
                        {{/if}}
                    </h3>
                    <textarea cols="50" id = "acts_text" disabled = disabled>{{user.activities}}</textarea>
                </div>
            </div>
        </div>
        <!-- END row-->
    </div>
</section>
<!-- Page footer-->
<footer>
    <span>Copyright &copy; 2015 Classwire</span>
</footer>

<script src="/js/searchbar.js"></script>

<script>
    function saveInfo(button){
        var textarea = document.getElementById(button.value);

        if(button.innerText === "Edit"){
            textarea.disabled = false;
            button.innerText = "Save";
        }else{
            textarea.disabled = true;
            if(button.value === 'acts_text'){
                makeAjax(textarea.value,'saveact');
            }else if(button.value === 'bio_text'){
                makeAjax(textarea.value,'savebio');
            }else if(button.value === 'grad_text'){
                makeAjax(textarea.value, 'savegrad');
            }else if(button.value === 'major_text'){
                makeAjax(textarea.value, 'savemajor');
            }

            button.innerText = 'Edit';
        }
    }

    function makeAjax(value, route){
        $.ajax({
            type: "POST",
            url: '/'+route,
            data: {val: value},
            success: function(){
                alert('Successful');
            }
        });
    }
</script>